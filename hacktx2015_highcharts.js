console.log('creating highcarts chart');

$(function () {

    // Give the points a 3D feel by adding a radial gradient
    Highcharts.getOptions().colors = $.map(Highcharts.getOptions().colors, function (color) {
        return {
            radialGradient: {
                cx: 0.4,
                cy: 0.3,
                r: 0.5
            },
            stops: [
                [0, color],
                [1, Highcharts.Color(color).brighten(-0.2).get('rgb')]
            ]
        };
    });

    // Set up the chart
    var chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            margin: 100,
            type: 'scatter',
            options3d: {
                enabled: true,
                alpha: 10,
                beta: 30,
                depth: 250,
                viewDistance: 5,

                frame: {
                    bottom: { size: 1, color: 'rgba(0,0,0,0.02)' },
                    back: { size: 1, color: 'rgba(0,0,0,0.04)' },
                    side: { size: 1, color: 'rgba(0,0,0,0.06)' }
                }
            }
        },
        title: {
            text: 'Draggable box'
        },
        subtitle: {
            text: 'Click and drag the plot area to rotate in space'
        },
        plotOptions: {
            scatter: {
                width: 10,
                height: 10,
                depth: 10
            }
        },
        xAxis: {
            min: -1000,
            max: 1000,
            gridLineWidth: 1
        },
        yAxis: {
            min: -1000,
            max: 3000,
            title: null
        },
        zAxis: {
            min: -4500,
            max: 2000,
            showFirstLabel: false
        },
        legend: {
            enabled: false
        },
        series: [{
            name: 'Reading',
            colorByPoint: true,
            data: [[104, -736, -592], [144, -736, -608], [144, -736, -584], [144, -704, -600], [144, -744, -632], [128, -736, -656], [112, -720, -672], [136, -736, -640], [168, -752, -600], [168, -752, -568], [176, -760, -608], [176, -776, -552], [168, -768, -568], [160, -760, -552], [176, -768, -560], [168, -776, -552], [176, -784, -584], [200, -792, -552], [192, -792, -560], [216, -800, -552], [224, -808, -568], [208, -792, -536], [200, -792, -536], [200, -784, -528], [216, -784, -552], [192, -792, -536], [192, -784, -576], [200, -792, -552], [216, -792, -568], [208, -800, -552], [216, -800, -544], [216, -816, -560], [200, -808, -568], [216, -816, -560], [216, -808, -560], [208, -808, -536], [192, -816, -560], [192, -816, -552], [192, -816, -528], [200, -832, -536], [192, -808, -504], [200, -816, -504], [192, -800, -520], [192, -808, -472], [184, -800, -488], [192, -816, -496], [200, -832, -488], [192, -832, -496], [192, -824, -496], [192, -808, -496], [216, -816, -504], [216, -824, -544], [224, -832, -512], [232, -824, -512], [216, -824, -528], [216, -832, -512], [216, -832, -520], [216, -832, -504], [208, -816, -496], [208, -816, -536], [184, -808, -528], [200, -808, -504], [200, -800, -520], [192, -816, -512], [200, -816, -536], [208, -816, -552], [200, -800, -528], [192, -800, -536], [192, -800, -536], [184, -808, -536], [192, -792, -544], [200, -776, -552], [208, -784, -536], [168, -768, -544], [168, -776, -576], [112, -768, -560], [128, -760, -624], [144, -744, -624], [160, -768, -648], [184, -776, -632], [208, -752, -608], [208, -752, -608], [192, -744, -608], [184, -752, -592], [176, -752, -632], [168, -744, -624], [168, -720, -648], [152, -704, -664], [144, -688, -672], [152, -688, -664], [192, -664, -616], [224, -632, -688], [200, -648, -656], [176, -656, -680], [176, -664, -728], [144, -656, -768], [144, -648, -872], [128, -648, -1024], [144, -680, -1112], [200, -664, -1056], [240, -672, -1072], [248, -624, -1056], [328, -672, -1224], [360, -720, -1480], [216, -672, -1432], [208, -640, -1440], [208, -648, -1416], [192, -560, -1288], [168, -504, -1024], [200, -456, -832], [224, -392, -664], [208, -288, -648], [136, -264, -832], [-24, -296, -856], [-168, -416, -904], [-272, -416, -656], [-280, -392, -560], [-200, -344, -320], [-160, -320, -328], [-176, -352, -328], [-208, -416, -344], [-256, -360, -512], [-320, -328, -1064], [-344, -312, -736], [-296, -328, -880], [-240, -264, -976], [-216, -168, -984], [-136, -88, -904], [-136, -24, -848], [-184, -16, -832], [-216, -32, -768], [-200, -96, -760], [-120, -120, -880], [-88, -112, -1200], [-120, -104, -1248], [-144, -96, -1160], [-152, -16, -1056], [-216, 16, -944], [-280, 40, -824], [-280, 24, -672], [-320, -16, -824], [-344, -32, -848], [-296, -48, -808], [-280, -32, -848], [-280, 0, -808], [-184, -56, -920], [-136, -80, -784], [-104, -72, -808], [-80, -64, -824], [-128, -56, -712], [-192, -16, -776], [-200, 8, -920], [-160, -8, -976], [-96, 24, -936], [-16, 40, -1000], [48, 40, -1016], [80, 80, -1024], [104, 88, -1096], [120, 112, -1120], [120, 112, -1112], [176, 120, -1128], [208, 128, -1120], [224, 136, -1120], [240, 136, -1176], [240, 136, -1120], [232, 136, -1152], [224, 136, -1104], [216, 104, -1120], [200, 112, -1016], [184, 104, -928], [208, 88, -928], [192, 120, -968], [152, 144, -992], [152, 160, -920], [136, 168, -896], [120, 176, -928], [72, 200, -944], [48, 216, -912], [32, 224, -888], [16, 240, -888], [8, 256, -888], [0, 264, -856], [16, 264, -880], [8, 264, -888], [16, 272, -880], [8, 288, -912], [8, 288, -912], [24, 272, -936], [48, 280, -920], [88, 272, -840], [112, 248, -936], [136, 240, -952], [144, 224, -952], [176, 232, -976], [176, 224, -984], [176, 240, -928], [176, 232, -1000], [176, 232, -1016], [168, 216, -976], [152, 224, -1000], [144, 224, -1024], [144, 232, -1000], [136, 216, -968], [152, 216, -984], [152, 224, -1000], [136, 248, -1056], [120, 280, -1016], [120, 288, -976], [112, 304, -920], [112, 304, -896], [128, 304, -872], [112, 288, -904], [104, 280, -888], [88, 280, -920], [80, 280, -888], [64, 272, -904], [32, 280, -904], [16, 224, -840], [0, 232, -864], [0, 216, -880], [8, 224, -872], [0, 240, -824], [-8, 280, -864], [-8, 264, -856], [-32, 256, -952], [-40, 264, -840], [-24, 288, -872], [-8, 288, -872], [-8, 312, -880], [-8, 328, -912], [-8, 344, -904], [-16, 360, -912], [0, 360, -912], [8, 344, -904], [24, 368, -952], [48, 360, -944], [80, 360, -976], [64, 384, -1000], [48, 400, -992], [8, 384, -976], [0, 400, -912], [64, 376, -824], [64, 376, -816], [72, 400, -768], [80, 392, -768], [80, 336, -832], [64, 304, -816], [72, 312, -792], [104, 296, -848], [176, 288, -896], [224, 248, -1128], [136, 208, -952], [64, 232, -912], [40, 192, -960], [48, 144, -936], [24, 136, -944], [16, 136, -928], [24, 168, -872], [40, 200, -872], [16, 216, -856], [-24, 232, -864], [-56, 232, -920], [-8, 184, -1000], [216, 232, -1528], [216, 80, -448], [392, 208, -880], [416, 208, -736], [472, 216, -720], [504, 296, -792], [432, 384, -736], [312, 496, -1184], [272, 616, -1048], [152, 608, -840], [152, 544, -672], [56, 552, -584], [32, 528, -552], [24, 536, -672], [40, 568, -616], [104, 624, -560], [144, 632, -552], [224, 520, -520], [216, 472, -504], [176, 424, -528], [144, 376, -368], [120, 344, -352], [112, 312, -232], [64, 264, 24], [-64, 696, 416], [120, 720, -488], [272, 840, 824], [352, 960, 1120], [208, 1328, 536], [-184, 2592, -472], [344, 1808, 1968], [120, 2296, -384], [200, 1728, -304], [320, 1376, 24], [96, 992, 40], [760, 232, 72], [592, 32, 32], [512, 32, 200], [344, 24, -184], [176, 8, -56], [40, -56, 72], [56, 24, -656], [-40, 0, -856], [232, -64, -4080], [64, -672, -1232], [-688, -736, -80], [-480, -128, -1064], [-232, -64, -616], [40, -40, -328], [248, -64, -232], [-568, -96, -1416], [-512, -72, -768], [-224, 752, -1048], [-760, 1376, -736], [-784, 848, -1256], [-152, 456, -376], [120, 120, -1512], [-128, -160, -1096], [-488, -168, -824], [-752, -200, -680], [-592, -128, -984], [-264, -168, -1000], [120, -776, 880], [112, -320, -128], [-112, -344, -1344], [-264, -320, -848], [-296, -136, -816], [-360, -192, -1032], [-160, -120, -1048], [-136, -56, -1120], [-160, -56, -904], [432, -248, -432], [152, -168, -1336], [56, -128, -1000], [-104, -64, -744], [-96, -16, -984], [-24, 0, -856], [-128, -16, -904], [-72, -24, -992], [-64, -16, -984], [-56, 0, -960], [-64, 0, -960], [-72, 0, -968], [-48, 0, -960], [-56, 0, -960], [-48, 0, -992], [-48, 0, -928], [-48, 0, -992], [-40, 0, -960], [-48, 8, -968], [-40, -8, -968], [-40, 0, -960], [-48, 0, -968], [-48, -8, -944], [-40, -16, -936], [-56, -8, -968], [-56, 0, -968], [-80, 24, -1008], [-56, 8, -952], [-56, 8, -976], [-64, 8, -960], [-64, 8, -1000], [-56, 0, -976], [-48, 8, -984], [-56, 0, -952], [-56, 0, -1016], [-56, 0, -968], [-56, 8, -960], [-56, 0, -952], [-64, 0, -960], [-56, 0, -968], [-64, 8, -968], [-56, 16, -960], [-56, 0, -976], [-56, -8, -944], [-56, 0, -968], [-56, 0, -952], [-48, 0, -952], [-48, 0, -976], [-48, 0, -960], [-56, -8, -968], [-56, 0, -936], [-64, -16, -944], [-40, -16, -888], [-56, -8, -968], [-56, -8, -944], [-56, 0, -968], [-72, 0, -960], [-56, 0, -968], [-56, 8, -968], [-56, 8, -984], [-48, 8, -960], [-56, 8, -960], [-64, 0, -976], [-64, -8, -984], [-80, -8, -952], [-72, 0, -944], [-64, 8, -968], [-64, 0, -960], [-64, -8, -984], [-48, -16, -936], [-48, -8, -976], [-56, -8, -984], [-56, -8, -960], [-56, 0, -952], [-56, 0, -968], [-56, -8, -1000], [-56, 0, -936], [-64, 8, -936], [-48, 16, -968], [-48, 8, -968], [-40, 8, -944], [-48, 0, -960], [-56, -8, -952], [-48, -8, -992], [-64, -24, -976], [-48, -8, -976], [-56, -8, -960], [-64, -8, -936], [-48, 0, -968], [-48, -8, -960], [-32, 8, -944], [-40, 0, -960], [-48, 8, -960], [-48, 0, -968], [-48, -8, -952], [-48, -24, -976], [-56, -16, -968], [-56, -16, -960], [-56, -16, -960], [-48, -8, -944], [-48, 24, -984], [-48, 8, -944], [-56, -8, -968], [-64, 0, -968], [-56, -16, -968], [-56, -16, -984], [-64, -16, -920], [-48, -8, -960], [-48, -16, -960], [-56, -16, -992], [-64, -16, -952], [-48, -16, -960], [-48, -16, -968], [-48, 8, -952], [-32, 16, -952], [-40, 8, -976], [-24, 0, -976], [-24, -8, -976], [-48, 8, -968], [-48, -8, -968], [-40, -8, -952], [-56, -8, -952], [-40, 0, -952], [-56, -8, -960], [-56, -16, -944], [-56, 8, -968], [-48, -8, -952], [-40, 0, -944], [-56, -8, -992], [-48, 0, -936], [-56, -16, -944], [-56, -8, -952], [-64, 0, -960], [-56, 0, -960], [-64, 0, -992], [-64, 0, -968], [-40, 8, -952], [-56, -8, -960], [-64, 0, -952], [-56, 0, -952], [-56, 8, -984], [-56, 0, -976], [-56, -8, -968], [-48, -8, -976], [-56, 0, -968], [-64, 8, -968], [-64, 0, -960], [-56, 8, -992], [-72, 8, -984], [-48, -8, -928], [-56, -16, -960], [-64, -16, -960], [-56, 0, -944], [-56, 8, -920], [-56, 0, -952], [-24, -8, -968], [-40, 0, -960], [-40, -16, -960], [-56, -16, -968], [-56, 0, -960], [-56, -8, -968], [-56, -8, -976], [-56, -8, -936], [-48, -16, -960], [-40, -16, -984], [-48, -8, -952], [-48, 0, -936], [-56, 0, -976], [-56, -8, -960], [-64, 0, -944], [-64, 0, -960], [-64, 0, -944], [-64, 16, -952], [-64, 8, -960], [-64, 0, -968], [-48, 0, -952], [-48, 8, -976], [-56, 0, -960], [-64, 0, -1000], [-48, -16, -960], [-64, -8, -944], [-56, -8, -960], [-64, -8, -960], [-64, 0, -960], [-48, 0, -920], [-48, 0, -976], [-64, -16, -960], [-56, -16, -968], [-64, -8, -960], [-64, -8, -952], [-56, -16, -968], [-64, -8, -984], [-56, -24, -976], [-48, -24, -944], [-56, -8, -976], [-48, -16, -960], [-40, 0, -968], [-56, 8, -968], [-56, 8, -960], [-56, 0, -960], [-40, 8, -976], [-48, 0, -968], [-48, -8, -920], [-48, 0, -984], [-48, 0, -984], [-48, 0, -944], [-32, 0, -944], [-40, -24, -944], [-64, -16, -960], [-56, -8, -944], [-64, -8, -968], [-64, 0, -968], [-64, 0, -960], [-64, 8, -960], [-56, 0, -960], [-56, 16, -968], [-48, 0, -960], [-48, 0, -976], [-48, -16, -976], [-64, -16, -952], [-80, 0, -968], [-56, -8, -976], [-48, 8, -944], [-64, -8, -968], [-56, 0, -952], [-48, 8, -960], [-32, 16, -984], [-40, 16, -936], [-40, 0, -960], [-48, -16, -960], [-56, -8, -960], [-56, -16, -960], [-64, -24, -968], [-64, 0, -928], [-56, -16, -960], [-48, -8, -976], [-48, 0, -960], [-48, -8, -960], [-56, -8, -952], [-48, 0, -968], [-56, 0, -960], [-48, 0, -968], [-40, 0, -968], [-56, -8, -960], [-56, -8, -968], [-48, 0, -952], [-56, 0, -968], [-56, 0, -968], [-56, 0, -960], [-56, 0, -968], [-56, -8, -976], [-56, 0, -960], [-56, 0, -968], [-56, 0, -968], [-48, 0, -960], [-48, 0, -968], [-48, -8, -976], [-48, -8, -968], [-56, 0, -968], [-56, 0, -960], [-56, -8, -968], [-56, -8, -944], [-48, 0, -960], [-48, 0, -952], [-56, 0, -960], [-56, 0, -960], [-48, 0, -960], [-56, -8, -968], [-48, -8, -960], [-48, -8, -952], [-56, -8, -960], [-80, 8, -960], [-72, 0, -976], [-48, -16, -952], [-56, -8, -928], [-56, -8, -968], [-56, -24, -960], [-56, 0, -944], [-80, 0, -968], [-88, 0, -976], [-80, 16, -952], [-72, 0, -928], [-56, 8, -968], [-56, -8, -968], [-72, 0, -944], [-48, -16, -960], [-48, -8, -952], [-40, 0, -968], [-40, -8, -968], [-48, 0, -952], [-56, 0, -960], [-64, -8, -976], [-56, 0, -944], [-56, -8, -976], [-56, -16, -944], [-56, 0, -952], [-48, -8, -944], [-56, -8, -968], [-48, -8, -960], [-40, -16, -960], [-40, -8, -984], [-48, -16, -976], [-40, -16, -928], [-48, 0, -976], [-64, 0, -936], [-56, 0, -968], [-56, -8, -976], [-64, -16, -952], [-56, -8, -944], [-56, 0, -960], [-56, -8, -952], [-72, -8, -984], [-64, -8, -952], [-56, 0, -968], [-56, 8, -944], [-40, -16, -920], [-32, 0, -944], [-40, 0, -952], [-56, 8, -1008], [-48, -8, -968], [-64, -8, -944], [-56, -16, -976], [-48, -16, -960], [-56, 8, -952], [-56, 0, -960], [-56, 16, -960], [-40, 8, -960], [-48, -16, -936], [-56, 0, -960], [-48, -8, -936], [-64, -8, -960], [-56, 0, -960], [-56, -24, -960], [-56, -8, -952], [-72, 0, -944], [-56, 0, -984], [-56, 0, -960], [-56, -8, -960], [-56, -8, -968], [-48, 16, -984], [-40, 0, -968], [-40, 16, -904], [-40, 0, -968], [-40, 0, -960], [-48, 0, -952], [-48, -16, -968], [-48, -8, -976], [-48, 8, -960], [-56, 8, -944], [-56, 0, -968], [-48, 0, -976], [-32, 16, -952], [-64, 0, -960], [-64, 8, -928], [-64, 8, -944], [-64, 0, -952], [-56, 0, -976], [-56, 8, -960], [-56, 0, -960], [-56, -16, -968], [-56, -8, -968], [-48, -8, -952], [-56, 0, -960], [-56, -16, -976], [-64, -8, -952], [-48, -8, -984], [-40, -8, -976], [-56, 8, -952], [-56, 16, -976], [-48, 0, -968], [-48, -16, -928], [-56, -32, -984], [-56, 0, -952], [-48, -8, -960], [-40, -8, -928], [-40, 8, -960], [-40, 0, -952], [-48, -8, -960], [-64, -8, -992], [-80, 0, -1000], [-64, -8, -960], [-72, -8, -968], [-64, -16, -968], [-48, -16, -976], [-40, 0, -992], [-40, 8, -968], [-48, -8, -960], [-40, 0, -944], [-48, -8, -960], [-56, 16, -960], [-56, 0, -976], [-32, 0, -968], [-56, 0, -992], [-64, 0, -960], [-56, 0, -960], [-48, -16, -968], [-48, -8, -960], [-56, -8, -960], [-56, -16, -960], [-80, 0, -960], [-48, 0, -928], [-64, 0, -976], [-72, -8, -944], [-64, -8, -960], [-64, -8, -984], [-48, 0, -968], [-56, 0, -952], [-56, 0, -976], [-56, 0, -936], [-56, 0, -960], [-56, 0, -968], [-56, -8, -968], [-32, -16, -952], [-32, -24, -976], [-48, -16, -976], [-56, -24, -960], [-48, -16, -960], [-48, -8, -952], [-48, 8, -968], [-64, 16, -968], [-64, 8, -952], [-48, 8, -960], [-48, 8, -976], [-48, 8, -968], [-64, 8, -912], [-56, 0, -936], [-56, 0, -968], [-56, 0, -928], [-64, 0, -952], [-56, 0, -968], [-56, -8, -960], [-48, -8, -952], [-48, -8, -976], [-56, 0, -952], [-56, 0, -952], [-64, -16, -976], [-56, -16, -968], [-40, 8, -976], [-48, 0, -976], [-64, 0, -968], [-48, 0, -952], [-48, 16, -920], [-64, -16, -984], [-64, -24, -960], [-64, -8, -960], [-64, -16, -976], [-56, -16, -952], [-48, -16, -1000], [-56, -8, -960], [-56, 0, -936], [-48, 8, -984], [-64, -8, -920], [-48, -16, -960], [-48, -8, -952], [-56, 8, -976], [-64, 0, -968], [-80, 0, -944], [-48, -8, -976], [-48, -8, -976], [-72, 16, -936], [-64, 0, -968], [-72, -8, -1000], [-64, -8, -912], [-64, -8, -960], [-24, -16, -984], [-56, -8, -920], [-24, 16, -960], [-48, 0, -1000], [-48, 0, -992], [-48, -8, -944], [-56, 8, -960], [-56, -16, -896], [-72, -24, -944], [-48, -16, -984], [-72, 8, -984], [-48, 0, -960], [-56, -32, -960], [-56, -16, -968], [-64, 0, -960], [-40, -8, -976], [-40, -8, -1008], [-64, -16, -960], [-16, -16, -960], [-16, -16, -976], [-48, -32, -976], [-56, -16, -960], [-48, -8, -960], [-56, -32, -976], [-64, -16, -960], [-48, -24, -1000], [-56, -8, -984], [-72, 0, -944], [-72, -8, -968], [-80, -8, -984], [-64, -8, -984], [-48, -8, -928], [-56, -8, -976], [-48, -16, -960], [-48, -8, -960], [-56, 0, -960], [-64, 8, -968], [-56, 0, -952], [-48, 16, -944], [-48, 16, -976], [-56, 8, -960], [-56, 0, -944], [-64, 0, -976], [-48, 0, -928], [-40, -8, -960], [-48, -8, -976], [-48, -8, -960], [-48, -8, -968], [-56, -24, -968], [-48, 0, -960], [-32, -8, -960], [-48, -8, -960], [-48, -24, -992], [-56, -16, -944], [-64, -8, -1072], [-40, 0, -968], [-40, 0, -928], [-32, -8, -952], [-40, 0, -968], [-40, 8, -992], [-40, 8, -968], [-56, 8, -952], [-56, -8, -984], [-56, 0, -952], [-56, -8, -984], [-72, 0, -960], [-104, 0, -976]]

        }]
    });


    // Add mouse events for rotation
    $(chart.container).bind('mousedown.hc touchstart.hc', function (e) {
        e = chart.pointer.normalize(e);

        var posX = e.pageX,
            posY = e.pageY,
            alpha = chart.options.chart.options3d.alpha,
            beta = chart.options.chart.options3d.beta,
            newAlpha,
            newBeta,
            sensitivity = 5; // lower is more sensitive

        $(document).bind({
            'mousemove.hc touchdrag.hc': function (e) {
                // Run beta
                newBeta = beta + (posX - e.pageX) / sensitivity;
                chart.options.chart.options3d.beta = newBeta;

                // Run alpha
                newAlpha = alpha + (e.pageY - posY) / sensitivity;
                chart.options.chart.options3d.alpha = newAlpha;

                chart.redraw(false);
            },
            'mouseup touchend': function () {
                $(document).unbind('.hc');
            }
        });
    });

});

